Análise Procrustes Generalizada

Entrada: Lista de formas F
Saída: Lista de formas F alinhadas e forma média m

Passos:

1. Fazer uma copia de uma forma aleatória (basta escolher a primeira forma da lista)
          alvo <= F[0]

2. Normalizar a forma alvo, dividindo o vetor pela sua própria magnitude
          alvo <= alvo  /  || alvo ||

3. Atribuir à forma média m o alvo normalizado
          m <= alvo

4. Guardar o valor atual de F
          F’ <= F

5. Alinhar cada forma da lista F com a média m
          F[i] <= procrustes(m,F[i]).Z

6. Atualizar a forma média m
          m <= calcular_forma_media(F)

7. Alinhar forma média m com o alvo
          m <= procrustes(alvo, m).Z

8. Normalizar a forma média m
          m <= m  /  || m ||

9. Se a lista F tiver sofrido alguma mudança durante o processo, ou seja, se F’ != F, voltar ao passo 4.